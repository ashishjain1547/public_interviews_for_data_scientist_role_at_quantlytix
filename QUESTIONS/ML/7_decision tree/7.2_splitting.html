<h2>4: How does a decision tree decide where to split?</h2>

<div class="markdown prose dark:prose-invert w-full break-words light"><p data-start="0" data-end="221">A <strong data-start="2" data-end="19">decision tree</strong> decides <strong data-start="28" data-end="46">where to split</strong> by choosing the feature and threshold that best <strong data-start="95" data-end="117">separates the data</strong> into “purer” subsets. The goal is to <strong data-start="155" data-end="184">maximize information gain</strong> (or minimize impurity) at each step.</p>
<hr data-start="223" data-end="226">
<h3 data-start="228" data-end="257">🔹 Step-by-Step Intuition</h3>
<ol data-start="259" data-end="524">
<li data-start="259" data-end="343">
<p data-start="262" data-end="343"><strong data-start="262" data-end="278">At each node</strong>, the tree evaluates <strong data-start="299" data-end="322">all possible splits</strong> across all features.</p>
</li>
<li data-start="344" data-end="423">
<p data-start="347" data-end="423">For each split, it measures how well the split separates the target classes.</p>
</li>
<li data-start="424" data-end="524">
<p data-start="427" data-end="524">It chooses the split that <strong data-start="453" data-end="482">reduces impurity the most</strong> (or increases information gain the most).</p>
</li>
</ol>
<hr data-start="526" data-end="529">
<h3 data-start="531" data-end="563">🔹 Common Splitting Criteria</h3>
<h4 data-start="565" data-end="643">1. <strong data-start="573" data-end="590">Gini Impurity</strong> (used in CART - Classification and Regression Trees)</h4>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msubsup><mi>p</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">Gini = 1 - \sum_{i=1}^{C} p_i^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">ini</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 3.106em; vertical-align: -1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span></span></span></span></span></span></span></span></span></span></span>
<p data-start="684" data-end="746">Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span></span></span></span> is the probability of class <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> in a node.</p>
<ul data-start="748" data-end="860">
<li data-start="748" data-end="781">
<p data-start="750" data-end="781">A node is <strong data-start="760" data-end="768">pure</strong> if Gini = 0.</p>
</li>
<li data-start="782" data-end="860">
<p data-start="784" data-end="860">The tree tries to <strong data-start="802" data-end="840">minimize the weighted average Gini</strong> of the child nodes.</p>
</li>
</ul>
<hr data-start="862" data-end="865">
<h4 data-start="867" data-end="919">2. <strong data-start="875" data-end="905">Entropy &amp; Information Gain</strong> (used in ID3)</h4>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Entropy</mtext><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Entropy} = - \sum_{i=1}^{C} p_i \log_2(p_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord text"><span class="mord">Entropy</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.106em; vertical-align: -1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8283em;"><span style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop"><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.207em;"><span style="top: -2.4559em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2441em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<span class="katex-display" style=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Information&nbsp;Gain</mtext><mo>=</mo><msub><mtext>Entropy</mtext><mtext>parent</mtext></msub><mo>−</mo><msub><mtext>Weighted&nbsp;Average&nbsp;Entropy</mtext><mtext>children</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Information Gain} = \text{Entropy}_{\text{parent}} - \text{Weighted Average Entropy}_{\text{children}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span class="mord">Information&nbsp;Gain</span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0636em; vertical-align: -0.3802em;"></span><span class="mord"><span class="mord text"><span class="mord">Entropy</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1864em;"><span style="top: -2.4559em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">parent</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3802em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9386em; vertical-align: -0.2441em;"></span><span class="mord"><span class="mord text"><span class="mord">Weighted&nbsp;Average&nbsp;Entropy</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.242em;"><span style="top: -2.4559em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">children</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2441em;"><span></span></span></span></span></span></span></span></span></span></span>
<p data-start="1093" data-end="1153">The split with the <strong data-start="1112" data-end="1140">highest information gain</strong> is selected.</p>
<hr data-start="1155" data-end="1158">
<h4 data-start="1160" data-end="1219">3. <strong data-start="1168" data-end="1196">Mean Squared Error (MSE)</strong> (for Regression Trees)</h4>
<p data-start="1221" data-end="1303">For regression, splits are based on minimizing the <strong data-start="1272" data-end="1279">MSE</strong> in the target variable.</p>
<hr data-start="1305" data-end="1308">
<h3 data-start="1310" data-end="1324">🔹 Example</h3>
<p data-start="1326" data-end="1411">Suppose a binary classification task and a feature <code data-start="1377" data-end="1382">Age</code>. A candidate split might be:</p>
<blockquote data-start="1413" data-end="1435">
<p data-start="1415" data-end="1435">Split at <code data-start="1424" data-end="1435">Age &lt;= 35</code></p>
</blockquote>
<p data-start="1437" data-end="1652">The tree checks how pure the resulting groups are after this split and compares it with other candidate splits (like <code data-start="1554" data-end="1565">Age &lt;= 30</code>, <code data-start="1567" data-end="1578">Age &lt;= 40</code>, etc.). The best one (lowest Gini or highest information gain) is chosen.</p>
<hr data-start="1654" data-end="1657">
<h3 data-start="1659" data-end="1673">🔹 Summary</h3>
<p data-start="1675" data-end="1716">A decision tree chooses a split based on:</p>
<ul data-start="1717" data-end="1838">
<li data-start="1717" data-end="1798">
<p data-start="1719" data-end="1798"><strong data-start="1719" data-end="1741">Impurity reduction</strong> (Gini or Entropy for classification, MSE for regression)</p>
</li>
<li data-start="1799" data-end="1838">
<p data-start="1801" data-end="1838"><strong data-start="1801" data-end="1815">Best split</strong> = Most pure + simplest</p>
</li>
</ul>
<p data-start="1840" data-end="1918">This process is repeated recursively at each node, building the tree top-down.</p>
<p data-start="1920" data-end="1998" data-is-last-node="" data-is-only-node="">Would you like a Python example to visualize how this split works in practice?</p></div>